<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="What do I get from WebRTC&rsquo;s data communication? #  WebRTC provides data channels for data communication. Between two peers you can open 65,534 data channels. A data channel is datagram based, and each has its own durability settings. By default each data channel has guaranteed ordered delivery.
If you are approaching WebRTC from a media background data channels might seem wasteful. Why do I need this whole subsystem when I could just use HTTP or WebSockets?"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Data Communication"><meta property="og:description" content="What do I get from WebRTC&rsquo;s data communication? #  WebRTC provides data channels for data communication. Between two peers you can open 65,534 data channels. A data channel is datagram based, and each has its own durability settings. By default each data channel has guaranteed ordered delivery.
If you are approaching WebRTC from a media background data channels might seem wasteful. Why do I need this whole subsystem when I could just use HTTP or WebSockets?"><meta property="og:type" content="article"><meta property="og:url" content="https://webrtcforthecurious.com/docs/07-data-communication/"><meta property="article:modified_time" content="2021-03-14T20:45:46-07:00"><meta property="og:site_name" content="WebRTC for the Curious"><title>Data Communication | WebRTC for the Curious</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=alternate hreflang=tr href=https://webrtcforthecurious.com/tr/docs/07-data-communication/ title="Data Communication"><link rel=alternate hreflang=zh href=https://webrtcforthecurious.com/zh/docs/07-data-communication/ title=数据通信><link rel=stylesheet href=/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY="><script defer src=/en.search.min.829de27c4d85600ee2dc358593cc43b859ad8b0239e20338fb620531e0aefa49.js integrity="sha256-gp3ifE2FYA7i3DWFk8xDuFmtiwI54gM4+2IFMeCu+kk="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>WebRTC for the Curious</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/01-what-why-and-how/>What, Why and How</a></li><li><a href=/docs/02-signaling/>Signaling</a></li><li><a href=/docs/03-connecting/>Connecting</a></li><li><a href=/docs/04-securing/>Securing</a></li><li><a href=/docs/05-real-time-networking/>Real-time Networking</a></li><li><a href=/docs/06-media-communication/>Media Communication</a></li><li><a href=/docs/07-data-communication/ class=active>Data Communication</a></li><li><a href=/docs/08-applied-webrtc/>Applied WebRTC</a></li><li><a href=/docs/09-debugging/>Debugging</a></li><li><a href=/docs/10-history-of-webrtc/>History</a></li><li><a href=/docs/11-faq/>FAQ</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Data Communication</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#how-does-it-work>How does it work</a></li><li><a href=#dcep>DCEP</a><ul><li><a href=#data_channel_open>DATA_CHANNEL_OPEN</a></li><li><a href=#data_channel_ack>DATA_CHANNEL_ACK</a></li></ul></li><li><a href=#sctp>SCTP</a></li><li><a href=#concepts>Concepts</a><ul><li><a href=#association>Association</a></li><li><a href=#streams>Streams</a></li><li><a href=#datagram-based>Datagram Based</a></li><li><a href=#chunks>Chunks</a></li><li><a href=#transmission-sequence-number>Transmission sequence number</a></li><li><a href=#stream-identifier>Stream identifier</a></li><li><a href=#payload-protocol-identifier>Payload protocol identifier</a></li></ul></li><li><a href=#protocol-1>Protocol</a><ul><li><a href=#abort-chunk>Abort Chunk</a></li><li><a href=#cookie-echo-chunk>Cookie Echo Chunk</a></li><li><a href=#data-chunk>Data Chunk</a></li><li><a href=#error-chunk>Error Chunk</a></li><li><a href=#forward-tsn-chunk>Forward TSN Chunk</a></li><li><a href=#heartbeat-request-chunk>Heartbeat Request Chunk</a></li><li><a href=#init-chunk>Init Chunk</a></li><li><a href=#selective-acknowledgment-chunk>Selective Acknowledgment Chunk</a></li><li><a href=#shutdown-chunk>Shutdown Chunk</a></li><li><a href=#reconfig-chunk>Reconfig Chunk</a></li></ul></li><li><a href=#state-machine>State Machine</a><ul><li><a href=#connection-establishment-flow>Connection establishment flow</a></li><li><a href=#connection-teardown-flow>Connection teardown flow</a></li><li><a href=#keep-alive-mechanism>Keep-alive mechanism</a></li><li><a href=#how-does-a-user-message-get-sent>How does a user message get sent?</a></li><li><a href=#tsn-and-retransmission>TSN and retransmission</a></li><li><a href=#congestion-avoidance>Congestion avoidance</a></li><li><a href=#selective-ack>Selective ACK</a></li><li><a href=#fast-retransmissionrecovery>Fast retransmission/recovery</a></li><li><a href=#partial-reliability>Partial Reliability</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=what-do-i-get-from-webrtcs-data-communication>What do I get from WebRTC&rsquo;s data communication?
<a class=anchor href=#what-do-i-get-from-webrtcs-data-communication>#</a></h1><p>WebRTC provides data channels for data communication. Between two peers you can open 65,534 data channels.
A data channel is datagram based, and each has its own durability settings. By default each data
channel has guaranteed ordered delivery.</p><p>If you are approaching WebRTC from a media background data channels might seem wasteful. Why do
I need this whole subsystem when I could just use HTTP or WebSockets?</p><p>The real power with data channels is that you can configure them to behave like UDP with unordered/lossy delivery.
This is necessary for low latency and high performance situations. You can measure the back pressure and ensure you
are only sending as much as your network supports.</p><h2 id=how-does-it-work>How does it work
<a class=anchor href=#how-does-it-work>#</a></h2><p>WebRTC uses SCTP, defined in <a href=https://tools.ietf.org/html/rfc2960>RFC 2960</a>. SCTP (Stream Control Transmission Protocol) is a
transport layer protocol and was intended as an alternative to TCP or UDP. For WebRTC we use it as an application layer protocol
it runs over our DTLS connection.</p><p>SCTP gives you streams and each stream can be configured. WebRTC data channels are just a thin abstraction around them. The settings
around durability/ordering are just passed right into the SCTP Agent.</p><p>Data channels have some features that SCTP can&rsquo;t express like channel labels. To solve that WebRTC uses the DCEP (Data Channel Establishment Protocol)
which is defined in <a href=https://tools.ietf.org/html/rfc8832>RFC 8832</a>. DCEP defines a messages to communicate the channel label and protocol</p><h2 id=dcep>DCEP
<a class=anchor href=#dcep>#</a></h2><p>DCEP only has two messages <code>DATA_CHANNEL_OPEN</code> and <code>DATA_CHANNEL_ACK</code>. For each data channel that is opened the remote must respond with an ack.</p><h3 id=data_channel_open>DATA_CHANNEL_OPEN
<a class=anchor href=#data_channel_open>#</a></h3><p>This message is sent by the WebRTC Agent that wishes to open a channel</p><h4 id=packet-format>Packet Format
<a class=anchor href=#packet-format>#</a></h4><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Message Type |  Channel Type |            Priority           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Reliability Parameter                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Label Length          |       Protocol Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               /
|                             Label                             |
/                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               /
|                            Protocol                           |
/                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h4 id=message-type>Message Type
<a class=anchor href=#message-type>#</a></h4><p>Message Type is a static value of <code>0x03</code></p><h4 id=channel-type>Channel Type
<a class=anchor href=#channel-type>#</a></h4><p>Channel Type controls durability/ordering attributes of the channel. It may have the following values.</p><ul><li><strong>DATA_CHANNEL_RELIABLE (0x00)</strong> - No messages are lost and will arrive in order</li><li><strong>DATA_CHANNEL_RELIABLE_UNORDERED (0x80)</strong> - No messages are lost and may arrive out of order</li><li><strong>DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT (0x01)</strong> - Messages may be lost after trying the requested amount of times and will arrive in order</li><li><strong>DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT_UNORDERED (0x81)</strong> - Messages may be lost after trying the requested amount of times and may arrive out of order</li><li><strong>DATA_CHANNEL_PARTIAL_RELIABLE_TIMED (0x02)</strong> - Messages may be lost if they don&rsquo;t arrive in the requested amount of time and will arrive in order</li><li><strong>DATA_CHANNEL_PARTIAL_RELIABLE_TIMED_UNORDERED (0x82)</strong> - Messages may be lost if they don&rsquo;t arrive in the requested amount of time and may arrive out of order</li></ul><h4 id=priority>Priority
<a class=anchor href=#priority>#</a></h4><p>The priority of the data channel. Data channels having a higher priority will be scheduled first. Large lower-priority user
messages will not delay the sending of higher-priority user messages.</p><h4 id=reliability-parameter>Reliability Parameter
<a class=anchor href=#reliability-parameter>#</a></h4><p>If a data channel is <code>DATA_CHANNEL_PARTIAL_RELIABLE</code> this configures the behavior.</p><p>If it is a <code>REXMIT</code> this parameter controls how many times the sender will re-send the message before giving up.</p><p>If it is a <code>TIMED</code> this parameter controls how long the sender will re-send the message before giving up.</p><h4 id=label>Label
<a class=anchor href=#label>#</a></h4><p>The name of the data channel as a UTF-8-encoded string. This may be an empty string.</p><h4 id=protocol>Protocol
<a class=anchor href=#protocol>#</a></h4><p>If this is an empty string, the protocol is unspecified. If it is
a non-empty string, it specifies a protocol registered in the
&ldquo;WebSocket Subprotocol Name Registry&rdquo;</p><h3 id=data_channel_ack>DATA_CHANNEL_ACK
<a class=anchor href=#data_channel_ack>#</a></h3><p>This message is sent by the WebRTC Agent to acknowledge that this data channel has been opened.</p><h4 id=packet-format-1>Packet Format
<a class=anchor href=#packet-format-1>#</a></h4><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Message Type |
+-+-+-+-+-+-+-+-+
</code></pre><h2 id=sctp>SCTP
<a class=anchor href=#sctp>#</a></h2><p>SCTP is the real power behind WebRTC data channels. It provides all these features of the data channel.</p><ul><li>Multiplexing</li><li>Reliable delivery using a TCP-like retransmission mechanism</li><li>Partial-reliability options</li><li>Congestion Avoidance</li><li>Flow Control</li></ul><p>To understand SCTP we explore it in 3 parts. The goal is to have info to debug and learn the
deep details of SCTP on your own after this chapter.</p><h2 id=concepts>Concepts
<a class=anchor href=#concepts>#</a></h2><p>SCTP is a feature rich protocol. This section is only going to cover the parts of SCTP that are used by WebRTC.
SCTP has some things that aren&rsquo;t used by WebRTC like multi-homing and path selection.</p><p>With over twenty years of development SCTP can be hard to fully graps.</p><h3 id=association>Association
<a class=anchor href=#association>#</a></h3><p>Association is the term used of a SCTP Session. It is the state that is shared
between two SCTP Agents while they communicate.</p><h3 id=streams>Streams
<a class=anchor href=#streams>#</a></h3><p>A stream is one bi-directional sequence of user data. When you create a data channel you are actually just creating a
SCTP stream. Each SCTP Association contains a list of streams. Each stream can be configured with differently reliability types.</p><p>WebRTC only allows you to configure on stream creation, but SCTP actually allows configuration at anytime.</p><h3 id=datagram-based>Datagram Based
<a class=anchor href=#datagram-based>#</a></h3><p>SCTP frames data as datagrams and not as a byte stream. Sending and receiving data feels like UDP instead of TCP. So you don&rsquo;t need
to add extra code to transfer multiple files over one stream.</p><p>SCTP messages don&rsquo;t have size limits like UDP. A single SCTP message can be multiple gigabytes in size.</p><h3 id=chunks>Chunks
<a class=anchor href=#chunks>#</a></h3><p>The SCTP protocol is made up of chunks. There are many different types of chunks. These chunks are used for all communication.
User data, connection initialized, congestion control and more is all done via chunks.</p><p>Each SCTP packet contains a list of chunks. So in one UDP packet you can have multiple chunks carrying messages from different streams.</p><h3 id=transmission-sequence-number>Transmission sequence number
<a class=anchor href=#transmission-sequence-number>#</a></h3><p>The TSN (Transmission sequence number) is a global unique identifier for DATA chunks. A DATA chunk is what carries all the messages
a user wishes to send. The TNS is important because it helps a receiver determine if packets are lost or out of order.</p><p>If the receiver sees it is missing a TSN it doesn&rsquo;t give the data to the user until it is fulfilled.</p><h3 id=stream-identifier>Stream identifier
<a class=anchor href=#stream-identifier>#</a></h3><p>Each stream has a unique identifier. When you create a data channel with an explicit ID it actually is just passed right into SCTP
as the stream identifier. If you don&rsquo;t pass an id the stream identifier is chosen for you.</p><h3 id=payload-protocol-identifier>Payload protocol identifier
<a class=anchor href=#payload-protocol-identifier>#</a></h3><p>Each DATA chunk also a PPID (Payload protocol identifier). This is used to uniquely identify what type of Data is being exchanged.
SCTP has many PPIDs, but WebRTC only uses the following 5.</p><ul><li><strong>WebRTC DCEP (50)</strong> - DCEP messages</li><li><strong>WebRTC String (51)</strong> - Datachannel string messages</li><li><strong>WebRTC Binary (53)</strong> - Datachannel binary messages</li><li><strong>WebRTC String Empty (56)</strong> - Datachannel string messages with 0 length</li><li><strong>WebRTC Binary Empty (57)</strong> - Datachannel binary messages with 0 length</li></ul><h2 id=protocol-1>Protocol
<a class=anchor href=#protocol-1>#</a></h2><h3 id=abort-chunk>Abort Chunk
<a class=anchor href=#abort-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 6    |Reserved     |T|           Length              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                                                               /
\               Zero or more Error Causes                       \
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><p>An ABORT chunk abruptly shuts down the the assocation. Used when
one side enters an error state. Gracefully ending the connection uses
the SHUTDOWN chunk.</p><h3 id=cookie-echo-chunk>Cookie Echo Chunk
<a class=anchor href=#cookie-echo-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 10   |Chunk  Flags   |         Length                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                     Cookie                                    /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=data-chunk>Data Chunk
<a class=anchor href=#data-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 0    | Reserved|U|B|E|    Length                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              TSN                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Stream Identifier S      |   Stream Sequence Number n    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Payload Protocol Identifier                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                 User Data (seq n of Stream S)                 /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=error-chunk>Error Chunk
<a class=anchor href=#error-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 9    | Chunk  Flags  |           Length              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                    one or more Error Causes                   /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=forward-tsn-chunk>Forward TSN Chunk
<a class=anchor href=#forward-tsn-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 192  |  Flags = 0x00 |        Length = Variable      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      New Cumulative TSN                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Stream-1              |       Stream Sequence-1       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               /
/                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Stream-N              |       Stream Sequence-N       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=heartbeat-request-chunk>Heartbeat Request Chunk
<a class=anchor href=#heartbeat-request-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 4    | Chunk  Flags  |      Heartbeat Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/            Heartbeat Information TLV (Variable-Length)        /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=init-chunk>Init Chunk
<a class=anchor href=#init-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 1    |  Chunk Flags  |      Chunk Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Initiate Tag                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Advertised Receiver Window Credit (a_rwnd)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Number of Outbound Streams   |  Number of Inbound Streams    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Initial TSN                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/              Optional/Variable-Length Parameters              /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=selective-acknowledgment-chunk>Selective Acknowledgment Chunk
<a class=anchor href=#selective-acknowledgment-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 3    |Chunk  Flags   |      Chunk Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Cumulative TSN Ack                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Advertised Receiver Window Credit (a_rwnd)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Number of Gap Ack Blocks = N  |  Number of Duplicate TSNs = X |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Gap Ack Block #1 Start       |   Gap Ack Block #1 End        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                                                               /
\                              ...                              \
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Gap Ack Block #N Start      |  Gap Ack Block #N End         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Duplicate TSN 1                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                                                               /
\                              ...                              \
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Duplicate TSN X                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=shutdown-chunk>Shutdown Chunk
<a class=anchor href=#shutdown-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 7    | Chunk  Flags  |      Length = 8               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Cumulative TSN Ack                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h3 id=reconfig-chunk>Reconfig Chunk
<a class=anchor href=#reconfig-chunk>#</a></h3><pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Type = 130    |  Chunk Flags  |      Chunk Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                  Re-configuration Parameter                   /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/             Re-configuration Parameter (optional)             /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre><h2 id=state-machine>State Machine
<a class=anchor href=#state-machine>#</a></h2><h3 id=connection-establishment-flow>Connection establishment flow
<a class=anchor href=#connection-establishment-flow>#</a></h3><h3 id=connection-teardown-flow>Connection teardown flow
<a class=anchor href=#connection-teardown-flow>#</a></h3><h3 id=keep-alive-mechanism>Keep-alive mechanism
<a class=anchor href=#keep-alive-mechanism>#</a></h3><h3 id=how-does-a-user-message-get-sent>How does a user message get sent?
<a class=anchor href=#how-does-a-user-message-get-sent>#</a></h3><h3 id=tsn-and-retransmission>TSN and retransmission
<a class=anchor href=#tsn-and-retransmission>#</a></h3><h3 id=congestion-avoidance>Congestion avoidance
<a class=anchor href=#congestion-avoidance>#</a></h3><h3 id=selective-ack>Selective ACK
<a class=anchor href=#selective-ack>#</a></h3><h3 id=fast-retransmissionrecovery>Fast retransmission/recovery
<a class=anchor href=#fast-retransmissionrecovery>#</a></h3><h3 id=partial-reliability>Partial Reliability
<a class=anchor href=#partial-reliability>#</a></h3></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div class=book-languages tabindex=0 aria-haspopup=true><ul><li class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</li></ul><ul class=book-languages-list><li class=active><a href=https://webrtcforthecurious.com/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></li><li><a href=https://webrtcforthecurious.com/tr/docs/07-data-communication/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
Turkish</a></li><li><a href=https://webrtcforthecurious.com/fa/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
Persian</a></li><li><a href=https://webrtcforthecurious.com/zh/docs/07-data-communication/ class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></li></ul></div><div><a class="flex align-center" href=https://github.com/webrtc-for-the-curious/webrtc-for-the-curious/commit/103fe96474651986510213f19173f02618e318a5 title="Last modified by Sean DuBois | March 15, 2021" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>March 15, 2021</span></a></div><div><a class="flex align-center" href=https://github.com/webrtc-for-the-curious/webrtc-for-the-curious/edit/master/content//docs/07-data-communication.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#how-does-it-work>How does it work</a></li><li><a href=#dcep>DCEP</a><ul><li><a href=#data_channel_open>DATA_CHANNEL_OPEN</a></li><li><a href=#data_channel_ack>DATA_CHANNEL_ACK</a></li></ul></li><li><a href=#sctp>SCTP</a></li><li><a href=#concepts>Concepts</a><ul><li><a href=#association>Association</a></li><li><a href=#streams>Streams</a></li><li><a href=#datagram-based>Datagram Based</a></li><li><a href=#chunks>Chunks</a></li><li><a href=#transmission-sequence-number>Transmission sequence number</a></li><li><a href=#stream-identifier>Stream identifier</a></li><li><a href=#payload-protocol-identifier>Payload protocol identifier</a></li></ul></li><li><a href=#protocol-1>Protocol</a><ul><li><a href=#abort-chunk>Abort Chunk</a></li><li><a href=#cookie-echo-chunk>Cookie Echo Chunk</a></li><li><a href=#data-chunk>Data Chunk</a></li><li><a href=#error-chunk>Error Chunk</a></li><li><a href=#forward-tsn-chunk>Forward TSN Chunk</a></li><li><a href=#heartbeat-request-chunk>Heartbeat Request Chunk</a></li><li><a href=#init-chunk>Init Chunk</a></li><li><a href=#selective-acknowledgment-chunk>Selective Acknowledgment Chunk</a></li><li><a href=#shutdown-chunk>Shutdown Chunk</a></li><li><a href=#reconfig-chunk>Reconfig Chunk</a></li></ul></li><li><a href=#state-machine>State Machine</a><ul><li><a href=#connection-establishment-flow>Connection establishment flow</a></li><li><a href=#connection-teardown-flow>Connection teardown flow</a></li><li><a href=#keep-alive-mechanism>Keep-alive mechanism</a></li><li><a href=#how-does-a-user-message-get-sent>How does a user message get sent?</a></li><li><a href=#tsn-and-retransmission>TSN and retransmission</a></li><li><a href=#congestion-avoidance>Congestion avoidance</a></li><li><a href=#selective-ack>Selective ACK</a></li><li><a href=#fast-retransmissionrecovery>Fast retransmission/recovery</a></li><li><a href=#partial-reliability>Partial Reliability</a></li></ul></li></ul></nav></aside></main></body></html>